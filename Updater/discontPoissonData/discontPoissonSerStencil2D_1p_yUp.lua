local Lin = require "Lib.Linalg"
local function stencilFn(dx, a, b, val)
  local _M = {}

  _M[1] = Lin.Mat(4,4)
  _M[1][1][1] = (81.0*b+6.0*a)/(36.0*dx[2]^2*b+8.0*dx[2]^2*a)
  _M[1][1][2] = 0.0
  _M[1][1][3] = (77.94228634059945*b+3.464101615137754*a)/(36.0*dx[2]^2*b+8.0*dx[2]^2*a)
  _M[1][1][4] = 0.0
  _M[1][2][1] = 0.0
  _M[1][2][2] = (81.0*b+6.0*a)/(36.0*dx[2]^2*b+8.0*dx[2]^2*a)
  _M[1][2][3] = 0.0
  _M[1][2][4] = (77.94228634059945*b+3.464101615137754*a)/(36.0*dx[2]^2*b+8.0*dx[2]^2*a)
  _M[1][3][1] = -(1.0*(98.726896031426*b+38.1051177665153*a))/(36.0*dx[2]^2*b+8.0*dx[2]^2*a)
  _M[1][3][2] = 0.0
  _M[1][3][3] = -(1.0*(87.0*b+38.0*a))/(36.0*dx[2]^2*b+8.0*dx[2]^2*a)
  _M[1][3][4] = 0.0
  _M[1][4][1] = 0.0
  _M[1][4][2] = -(1.0*(98.726896031426*b+38.1051177665153*a))/(36.0*dx[2]^2*b+8.0*dx[2]^2*a)
  _M[1][4][3] = 0.0
  _M[1][4][4] = -(1.0*(87.0*b+38.0*a))/(36.0*dx[2]^2*b+8.0*dx[2]^2*a)
  _M[2] = Lin.Mat(4,4)
  _M[2][1][1] = -(1.0*(81.0*b+78.0*a))/(36.0*dx[2]^2*b+8.0*dx[2]^2*a)
  _M[2][1][2] = 0.0
  _M[2][1][3] = (77.94228634059945*b-107.3871500692704*a)/(36.0*dx[2]^2*b+8.0*dx[2]^2*a)
  _M[2][1][4] = 0.0
  _M[2][2][1] = 0.0
  _M[2][2][2] = -(1.0*(81.0*b+78.0*a))/(36.0*dx[2]^2*b+8.0*dx[2]^2*a)
  _M[2][2][3] = 0.0
  _M[2][2][4] = (77.94228634059945*b-107.3871500692704*a)/(36.0*dx[2]^2*b+8.0*dx[2]^2*a)
  _M[2][3][1] = (98.726896031426*b-58.88972745734183*a)/(36.0*dx[2]^2*b+8.0*dx[2]^2*a)
  _M[2][3][2] = 0.0
  _M[2][3][3] = -(1.0*(423.0*b+262.0*a))/(36.0*dx[2]^2*b+8.0*dx[2]^2*a)
  _M[2][3][4] = 0.0
  _M[2][4][1] = 0.0
  _M[2][4][2] = (98.726896031426*b-58.88972745734183*a)/(36.0*dx[2]^2*b+8.0*dx[2]^2*a)
  _M[2][4][3] = 0.0
  _M[2][4][4] = -(1.0*(423.0*b+262.0*a))/(36.0*dx[2]^2*b+8.0*dx[2]^2*a)
  _M[3] = Lin.Vec(4)
  _M[3][1] = 36.0/(9.0*dx[2]^2*b+2.0*dx[2]^2*a)*val
  _M[3][2] = 0.0*val
  _M[3][3] = 48.49742261192856/(9.0*dx[2]^2*b+2.0*dx[2]^2*a)*val
  _M[3][4] = 0.0*val
  return(_M)
end

return(stencilFn)