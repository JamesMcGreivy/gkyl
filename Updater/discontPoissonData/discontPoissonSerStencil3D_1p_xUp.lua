local Lin = require "Lib.Linalg"
local function stencilFn(dx, a, b, val)
  local _M = {}

  _M[1] = Lin.Mat(8,8)
  _M[1][1][1] = (324.0*b+24.0*a)/(144.0*dx[1]^2*b+32.0*dx[1]^2*a)
  _M[1][1][2] = (155.8845726811989*b+6.928203230275509*a)/(72.0*dx[1]^2*b+16.0*dx[1]^2*a)
  _M[1][1][3] = 0.0
  _M[1][1][4] = 0.0
  _M[1][1][5] = 0.0
  _M[1][1][6] = 0.0
  _M[1][1][7] = 0.0
  _M[1][1][8] = 0.0
  _M[1][2][1] = -(1.0*(394.907584125704*b+152.4204710660612*a))/(144.0*dx[1]^2*b+32.0*dx[1]^2*a)
  _M[1][2][2] = -(1.0*(174.0*b+76.0*a))/(72.0*dx[1]^2*b+16.0*dx[1]^2*a)
  _M[1][2][3] = 0.0
  _M[1][2][4] = 0.0
  _M[1][2][5] = 0.0
  _M[1][2][6] = 0.0
  _M[1][2][7] = 0.0
  _M[1][2][8] = 0.0
  _M[1][3][1] = 0.0
  _M[1][3][2] = 0.0
  _M[1][3][3] = (81.0*b+6.0*a)/(36.0*dx[1]^2*b+8.0*dx[1]^2*a)
  _M[1][3][4] = 0.0
  _M[1][3][5] = (77.94228634059945*b+3.464101615137754*a)/(36.0*dx[1]^2*b+8.0*dx[1]^2*a)
  _M[1][3][6] = 0.0
  _M[1][3][7] = 0.0
  _M[1][3][8] = 0.0
  _M[1][4][1] = 0.0
  _M[1][4][2] = 0.0
  _M[1][4][3] = 0.0
  _M[1][4][4] = (81.0*b+6.0*a)/(36.0*dx[1]^2*b+8.0*dx[1]^2*a)
  _M[1][4][5] = 0.0
  _M[1][4][6] = (77.94228634059945*b+3.464101615137754*a)/(36.0*dx[1]^2*b+8.0*dx[1]^2*a)
  _M[1][4][7] = 0.0
  _M[1][4][8] = 0.0
  _M[1][5][1] = 0.0
  _M[1][5][2] = 0.0
  _M[1][5][3] = -(1.0*(98.726896031426*b+38.1051177665153*a))/(36.0*dx[1]^2*b+8.0*dx[1]^2*a)
  _M[1][5][4] = 0.0
  _M[1][5][5] = -(1.0*(87.0*b+38.0*a))/(36.0*dx[1]^2*b+8.0*dx[1]^2*a)
  _M[1][5][6] = 0.0
  _M[1][5][7] = 0.0
  _M[1][5][8] = 0.0
  _M[1][6][1] = 0.0
  _M[1][6][2] = 0.0
  _M[1][6][3] = 0.0
  _M[1][6][4] = -(1.0*(98.726896031426*b+38.1051177665153*a))/(36.0*dx[1]^2*b+8.0*dx[1]^2*a)
  _M[1][6][5] = 0.0
  _M[1][6][6] = -(1.0*(87.0*b+38.0*a))/(36.0*dx[1]^2*b+8.0*dx[1]^2*a)
  _M[1][6][7] = 0.0
  _M[1][6][8] = 0.0
  _M[1][7][1] = 0.0
  _M[1][7][2] = 0.0
  _M[1][7][3] = 0.0
  _M[1][7][4] = 0.0
  _M[1][7][5] = 0.0
  _M[1][7][6] = 0.0
  _M[1][7][7] = (81.0*b+6.0*a)/(36.0*dx[1]^2*b+8.0*dx[1]^2*a)
  _M[1][7][8] = (77.94228634059945*b+3.464101615137754*a)/(36.0*dx[1]^2*b+8.0*dx[1]^2*a)
  _M[1][8][1] = 0.0
  _M[1][8][2] = 0.0
  _M[1][8][3] = 0.0
  _M[1][8][4] = 0.0
  _M[1][8][5] = 0.0
  _M[1][8][6] = 0.0
  _M[1][8][7] = -(1.0*(98.726896031426*b+38.1051177665153*a))/(36.0*dx[1]^2*b+8.0*dx[1]^2*a)
  _M[1][8][8] = -(1.0*(87.0*b+38.0*a))/(36.0*dx[1]^2*b+8.0*dx[1]^2*a)
  _M[2] = Lin.Mat(8,8)
  _M[2][1][1] = -(1.0*(324.0*b+312.0*a))/(144.0*dx[1]^2*b+32.0*dx[1]^2*a)
  _M[2][1][2] = (155.8845726811989*b-214.7743001385408*a)/(72.0*dx[1]^2*b+16.0*dx[1]^2*a)
  _M[2][1][3] = 0.0
  _M[2][1][4] = 0.0
  _M[2][1][5] = 0.0
  _M[2][1][6] = 0.0
  _M[2][1][7] = 0.0
  _M[2][1][8] = 0.0
  _M[2][2][1] = (394.907584125704*b-235.5589098293673*a)/(144.0*dx[1]^2*b+32.0*dx[1]^2*a)
  _M[2][2][2] = -(1.0*(846.0*b+524.0*a))/(72.0*dx[1]^2*b+16.0*dx[1]^2*a)
  _M[2][2][3] = 0.0
  _M[2][2][4] = 0.0
  _M[2][2][5] = 0.0
  _M[2][2][6] = 0.0
  _M[2][2][7] = 0.0
  _M[2][2][8] = 0.0
  _M[2][3][1] = 0.0
  _M[2][3][2] = 0.0
  _M[2][3][3] = -(1.0*(81.0*b+78.0*a))/(36.0*dx[1]^2*b+8.0*dx[1]^2*a)
  _M[2][3][4] = 0.0
  _M[2][3][5] = (77.94228634059945*b-107.3871500692704*a)/(36.0*dx[1]^2*b+8.0*dx[1]^2*a)
  _M[2][3][6] = 0.0
  _M[2][3][7] = 0.0
  _M[2][3][8] = 0.0
  _M[2][4][1] = 0.0
  _M[2][4][2] = 0.0
  _M[2][4][3] = 0.0
  _M[2][4][4] = -(1.0*(81.0*b+78.0*a))/(36.0*dx[1]^2*b+8.0*dx[1]^2*a)
  _M[2][4][5] = 0.0
  _M[2][4][6] = (77.94228634059945*b-107.3871500692704*a)/(36.0*dx[1]^2*b+8.0*dx[1]^2*a)
  _M[2][4][7] = 0.0
  _M[2][4][8] = 0.0
  _M[2][5][1] = 0.0
  _M[2][5][2] = 0.0
  _M[2][5][3] = (98.726896031426*b-58.88972745734183*a)/(36.0*dx[1]^2*b+8.0*dx[1]^2*a)
  _M[2][5][4] = 0.0
  _M[2][5][5] = -(1.0*(423.0*b+262.0*a))/(36.0*dx[1]^2*b+8.0*dx[1]^2*a)
  _M[2][5][6] = 0.0
  _M[2][5][7] = 0.0
  _M[2][5][8] = 0.0
  _M[2][6][1] = 0.0
  _M[2][6][2] = 0.0
  _M[2][6][3] = 0.0
  _M[2][6][4] = (98.726896031426*b-58.88972745734183*a)/(36.0*dx[1]^2*b+8.0*dx[1]^2*a)
  _M[2][6][5] = 0.0
  _M[2][6][6] = -(1.0*(423.0*b+262.0*a))/(36.0*dx[1]^2*b+8.0*dx[1]^2*a)
  _M[2][6][7] = 0.0
  _M[2][6][8] = 0.0
  _M[2][7][1] = 0.0
  _M[2][7][2] = 0.0
  _M[2][7][3] = 0.0
  _M[2][7][4] = 0.0
  _M[2][7][5] = 0.0
  _M[2][7][6] = 0.0
  _M[2][7][7] = -(1.0*(81.0*b+78.0*a))/(36.0*dx[1]^2*b+8.0*dx[1]^2*a)
  _M[2][7][8] = (77.94228634059945*b-107.3871500692704*a)/(36.0*dx[1]^2*b+8.0*dx[1]^2*a)
  _M[2][8][1] = 0.0
  _M[2][8][2] = 0.0
  _M[2][8][3] = 0.0
  _M[2][8][4] = 0.0
  _M[2][8][5] = 0.0
  _M[2][8][6] = 0.0
  _M[2][8][7] = (98.726896031426*b-58.88972745734183*a)/(36.0*dx[1]^2*b+8.0*dx[1]^2*a)
  _M[2][8][8] = -(1.0*(423.0*b+262.0*a))/(36.0*dx[1]^2*b+8.0*dx[1]^2*a)
  _M[3] = Lin.Vec(8)
  _M[3][1] = 288.0/(50.91168824543144*dx[1]^2*b+11.31370849898477*dx[1]^2*a)*val
  _M[3][2] = 387.9793808954285/(50.91168824543144*dx[1]^2*b+11.31370849898477*dx[1]^2*a)*val
  _M[3][3] = 0.0*val
  _M[3][4] = 0.0*val
  _M[3][5] = 0.0*val
  _M[3][6] = 0.0*val
  _M[3][7] = 0.0*val
  _M[3][8] = 0.0*val
  return(_M)
end

return(stencilFn)