local Lin = require "Lib.Linalg"
local function stencilFn(dx, a, b, val)
  local _M = {}

  _M[1] = Lin.Mat(8,8)
  _M[1][1][1] = (75.0*b+20.0*a)/(20.0*dx[1]^2*b+2.0*dx[1]^2*a)
  _M[1][1][2] = (381.051177665153*b+112.583302491977*a)/(80.0*dx[1]^2*b+8.0*dx[1]^2*a)
  _M[1][1][3] = 0.0
  _M[1][1][4] = 0.0
  _M[1][1][5] = (214.6625258399798*b+78.26237921249266*a)/(80.0*dx[1]^2*b+8.0*dx[1]^2*a)
  _M[1][1][6] = 0.0
  _M[1][1][7] = 0.0
  _M[1][1][8] = 0.0
  _M[1][2][1] = -(1.0*(147.2243186433546*b-24.24871130596428*a))/(40.0*dx[1]^2*b+4.0*dx[1]^2*a)
  _M[1][2][2] = -(1.0*(672.0*b-165.0*a))/(160.0*dx[1]^2*b+16.0*dx[1]^2*a)
  _M[1][2][3] = 0.0
  _M[1][2][4] = 0.0
  _M[1][2][5] = -(1.0*(1378.78207124984*b-747.4857858180314*a))/(800.0*dx[1]^2*b+80.0*dx[1]^2*a)
  _M[1][2][6] = 0.0
  _M[1][2][7] = 0.0
  _M[1][2][8] = 0.0
  _M[1][3][1] = 0.0
  _M[1][3][2] = 0.0
  _M[1][3][3] = (75.0*b+20.0*a)/(20.0*dx[1]^2*b+2.0*dx[1]^2*a)
  _M[1][3][4] = (1143.153532995459*b+337.749907475931*a)/(240.0*dx[1]^2*b+24.0*dx[1]^2*a)
  _M[1][3][5] = 0.0
  _M[1][3][6] = 0.0
  _M[1][3][7] = (643.9875775199394*b+234.7871376374779*a)/(240.0*dx[1]^2*b+24.0*dx[1]^2*a)
  _M[1][3][8] = 0.0
  _M[1][4][1] = 0.0
  _M[1][4][2] = 0.0
  _M[1][4][3] = -(1.0*(147.2243186433546*b-24.24871130596428*a))/(40.0*dx[1]^2*b+4.0*dx[1]^2*a)
  _M[1][4][4] = -(1.0*(672.0*b-165.0*a))/(160.0*dx[1]^2*b+16.0*dx[1]^2*a)
  _M[1][4][5] = 0.0
  _M[1][4][6] = 0.0
  _M[1][4][7] = -(1.0*(1378.78207124984*b-747.4857858180314*a))/(800.0*dx[1]^2*b+80.0*dx[1]^2*a)
  _M[1][4][8] = 0.0
  _M[1][5][1] = (234.787137637478*b+62.60990336999411*a)/(40.0*dx[1]^2*b+4.0*dx[1]^2*a)
  _M[1][5][2] = (1192.878870631884*b+352.441484504875*a)/(160.0*dx[1]^2*b+16.0*dx[1]^2*a)
  _M[1][5][3] = 0.0
  _M[1][5][4] = 0.0
  _M[1][5][5] = (672.0*b+245.0*a)/(160.0*dx[1]^2*b+16.0*dx[1]^2*a)
  _M[1][5][6] = 0.0
  _M[1][5][7] = 0.0
  _M[1][5][8] = 0.0
  _M[1][6][1] = 0.0
  _M[1][6][2] = 0.0
  _M[1][6][3] = 0.0
  _M[1][6][4] = 0.0
  _M[1][6][5] = 0.0
  _M[1][6][6] = (75.0*b+20.0*a)/(20.0*dx[1]^2*b+2.0*dx[1]^2*a)
  _M[1][6][7] = 0.0
  _M[1][6][8] = (381.051177665153*b+112.583302491977*a)/(80.0*dx[1]^2*b+8.0*dx[1]^2*a)
  _M[1][7][1] = 0.0
  _M[1][7][2] = 0.0
  _M[1][7][3] = (704.3614129124337*b+187.8297101099823*a)/(120.0*dx[1]^2*b+12.0*dx[1]^2*a)
  _M[1][7][4] = (1192.878870631884*b+352.441484504875*a)/(160.0*dx[1]^2*b+16.0*dx[1]^2*a)
  _M[1][7][5] = 0.0
  _M[1][7][6] = 0.0
  _M[1][7][7] = (672.0*b+245.0*a)/(160.0*dx[1]^2*b+16.0*dx[1]^2*a)
  _M[1][7][8] = 0.0
  _M[1][8][1] = 0.0
  _M[1][8][2] = 0.0
  _M[1][8][3] = 0.0
  _M[1][8][4] = 0.0
  _M[1][8][5] = 0.0
  _M[1][8][6] = -(1.0*(736.121593216773*b-121.2435565298214*a))/(200.0*dx[1]^2*b+20.0*dx[1]^2*a)
  _M[1][8][7] = 0.0
  _M[1][8][8] = -(1.0*(672.0*b-165.0*a))/(160.0*dx[1]^2*b+16.0*dx[1]^2*a)
  _M[2] = Lin.Mat(8,8)
  _M[2][1][1] = -(1.0*(75.0*b+60.0*a))/(20.0*dx[1]^2*b+2.0*dx[1]^2*a)
  _M[2][1][2] = (381.051177665153*b-112.583302491977*a)/(80.0*dx[1]^2*b+8.0*dx[1]^2*a)
  _M[2][1][3] = 0.0
  _M[2][1][4] = 0.0
  _M[2][1][5] = -(1.0*(214.6625258399798*b+422.6168477474603*a))/(80.0*dx[1]^2*b+8.0*dx[1]^2*a)
  _M[2][1][6] = 0.0
  _M[2][1][7] = 0.0
  _M[2][1][8] = 0.0
  _M[2][2][1] = (147.2243186433546*b-148.9563694509234*a)/(40.0*dx[1]^2*b+4.0*dx[1]^2*a)
  _M[2][2][2] = -(1.0*(2232.0*b+693.0*a))/(160.0*dx[1]^2*b+16.0*dx[1]^2*a)
  _M[2][2][3] = 0.0
  _M[2][2][4] = 0.0
  _M[2][2][5] = -(1.0*(1874.52393956439*b+6440.771304742934*a))/(800.0*dx[1]^2*b+80.0*dx[1]^2*a)
  _M[2][2][6] = 0.0
  _M[2][2][7] = 0.0
  _M[2][2][8] = 0.0
  _M[2][3][1] = 0.0
  _M[2][3][2] = 0.0
  _M[2][3][3] = -(1.0*(75.0*b+60.0*a))/(20.0*dx[1]^2*b+2.0*dx[1]^2*a)
  _M[2][3][4] = (1143.153532995459*b-337.749907475931*a)/(240.0*dx[1]^2*b+24.0*dx[1]^2*a)
  _M[2][3][5] = 0.0
  _M[2][3][6] = 0.0
  _M[2][3][7] = -(1.0*(643.9875775199394*b+1267.85054324238*a))/(240.0*dx[1]^2*b+24.0*dx[1]^2*a)
  _M[2][3][8] = 0.0
  _M[2][4][1] = 0.0
  _M[2][4][2] = 0.0
  _M[2][4][3] = (147.2243186433546*b-148.9563694509234*a)/(40.0*dx[1]^2*b+4.0*dx[1]^2*a)
  _M[2][4][4] = -(1.0*(2232.0*b+693.0*a))/(160.0*dx[1]^2*b+16.0*dx[1]^2*a)
  _M[2][4][5] = 0.0
  _M[2][4][6] = 0.0
  _M[2][4][7] = -(1.0*(1874.52393956439*b+6440.771304742934*a))/(800.0*dx[1]^2*b+80.0*dx[1]^2*a)
  _M[2][4][8] = 0.0
  _M[2][5][1] = -(1.0*(234.787137637478*b+187.8297101099823*a))/(40.0*dx[1]^2*b+4.0*dx[1]^2*a)
  _M[2][5][2] = (1192.878870631884*b-352.441484504875*a)/(160.0*dx[1]^2*b+16.0*dx[1]^2*a)
  _M[2][5][3] = 0.0
  _M[2][5][4] = 0.0
  _M[2][5][5] = -(1.0*(7392.0*b+1995.0*a))/(160.0*dx[1]^2*b+16.0*dx[1]^2*a)
  _M[2][5][6] = 0.0
  _M[2][5][7] = 0.0
  _M[2][5][8] = 0.0
  _M[2][6][1] = 0.0
  _M[2][6][2] = 0.0
  _M[2][6][3] = 0.0
  _M[2][6][4] = 0.0
  _M[2][6][5] = 0.0
  _M[2][6][6] = -(1.0*(75.0*b+60.0*a))/(20.0*dx[1]^2*b+2.0*dx[1]^2*a)
  _M[2][6][7] = 0.0
  _M[2][6][8] = (381.051177665153*b-112.583302491977*a)/(80.0*dx[1]^2*b+8.0*dx[1]^2*a)
  _M[2][7][1] = 0.0
  _M[2][7][2] = 0.0
  _M[2][7][3] = -(1.0*(704.3614129124337*b+563.4891303299469*a))/(120.0*dx[1]^2*b+12.0*dx[1]^2*a)
  _M[2][7][4] = (1192.878870631884*b-352.441484504875*a)/(160.0*dx[1]^2*b+16.0*dx[1]^2*a)
  _M[2][7][5] = 0.0
  _M[2][7][6] = 0.0
  _M[2][7][7] = -(1.0*(7392.0*b+1995.0*a))/(160.0*dx[1]^2*b+16.0*dx[1]^2*a)
  _M[2][7][8] = 0.0
  _M[2][8][1] = 0.0
  _M[2][8][2] = 0.0
  _M[2][8][3] = 0.0
  _M[2][8][4] = 0.0
  _M[2][8][5] = 0.0
  _M[2][8][6] = (736.121593216773*b-744.7818472546173*a)/(200.0*dx[1]^2*b+20.0*dx[1]^2*a)
  _M[2][8][7] = 0.0
  _M[2][8][8] = -(1.0*(2232.0*b+693.0*a))/(160.0*dx[1]^2*b+16.0*dx[1]^2*a)
  _M[3] = Lin.Vec(8)
  _M[3][1] = 40.0/(10.0*dx[1]^2*b+dx[1]^2*a)*val
  _M[3][2] = 62.35382907247957/(10.0*dx[1]^2*b+dx[1]^2*a)*val
  _M[3][3] = 0.0*val
  _M[3][4] = 0.0*val
  _M[3][5] = 62.60990336999411/(10.0*dx[1]^2*b+dx[1]^2*a)*val
  _M[3][6] = 0.0*val
  _M[3][7] = 0.0*val
  _M[3][8] = 0.0*val
  return(_M)
end

return(stencilFn)