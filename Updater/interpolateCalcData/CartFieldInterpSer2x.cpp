#include <CartFieldInterpolateModDecl.h> 
 
void CartFieldInterpProlong2xSer_P1(const double *wC, const double *wF, const double *dxC, const double *dxF, const double *fldC, double *fldF) 
{ 
  // wC:   cell center of coarse-grid cell.
  // wF:   cell center of fine-grid cell.
  // dxC:  cell length of coarse-grid cell.
  // dxF:  cell length of fine-grid cell.
  // fldC: coarse-grid field.
  // fldF: fine-grid field in cells pointed to by the stencil.

  double eLo[2];
  double eUp[2];
  eLo[0] = std::max(-1.0,1.0-(2.0*(wF[0]-1.0*wC[0]+0.5*dxF[0]+0.5*dxC[0]))/dxF[0]);
  eUp[0] = std::min( 1.0,(2.0*((-1.0*wF[0])+wC[0]+0.5*dxF[0]+0.5*dxC[0]))/dxF[0]-1.0);
  eLo[1] = std::max(-1.0,1.0-(2.0*(wF[1]-1.0*wC[1]+0.5*dxF[1]+0.5*dxC[1]))/dxF[1]);
  eUp[1] = std::min( 1.0,(2.0*((-1.0*wF[1])+wC[1]+0.5*dxF[1]+0.5*dxC[1]))/dxF[1]-1.0);

  double eLo0R2 = std::pow(eLo[0],2);
  double eLo1R2 = std::pow(eLo[1],2);
  double eLo0R3 = std::pow(eLo[0],3);
  double eLo1R3 = std::pow(eLo[1],3);
  double eUp0R2 = std::pow(eUp[0],2);
  double eUp1R2 = std::pow(eUp[1],2);
  double eUp0R3 = std::pow(eUp[0],3);
  double eUp1R3 = std::pow(eUp[1],3);

  fldF[0] += (0.0625*(((((48.0*eUp[0]-48.0*eLo[0])*wF[0]+(48.0*eLo[0]-48.0*eUp[0])*wC[0]+12.0*dxF[0]*eUp0R2-12.0*dxF[0]*eLo0R2)*eUp[1]+((48.0*eLo[0]-48.0*eUp[0])*wF[0]+(48.0*eUp[0]-48.0*eLo[0])*wC[0]-12.0*dxF[0]*eUp0R2+12.0*dxF[0]*eLo0R2)*eLo[1])*wF[1]+(((48.0*eLo[0]-48.0*eUp[0])*wF[0]+(48.0*eUp[0]-48.0*eLo[0])*wC[0]-12.0*dxF[0]*eUp0R2+12.0*dxF[0]*eLo0R2)*eUp[1]+((48.0*eUp[0]-48.0*eLo[0])*wF[0]+(48.0*eLo[0]-48.0*eUp[0])*wC[0]+12.0*dxF[0]*eUp0R2-12.0*dxF[0]*eLo0R2)*eLo[1])*wC[1]+((12.0*eUp[0]-12.0*eLo[0])*wF[0]+(12.0*eLo[0]-12.0*eUp[0])*wC[0]+3.0*dxF[0]*eUp0R2-3.0*dxF[0]*eLo0R2)*dxF[1]*eUp1R2+((12.0*eLo[0]-12.0*eUp[0])*wF[0]+(12.0*eUp[0]-12.0*eLo[0])*wC[0]-3.0*dxF[0]*eUp0R2+3.0*dxF[0]*eLo0R2)*dxF[1]*eLo1R2)*fldC[3]+(((13.85640646055102*dxC[0]*eUp[0]-13.85640646055102*dxC[0]*eLo[0])*eUp[1]+(13.85640646055102*dxC[0]*eLo[0]-13.85640646055102*dxC[0]*eUp[0])*eLo[1])*wF[1]+((13.85640646055102*dxC[0]*eLo[0]-13.85640646055102*dxC[0]*eUp[0])*eUp[1]+(13.85640646055102*dxC[0]*eUp[0]-13.85640646055102*dxC[0]*eLo[0])*eLo[1])*wC[1]+(3.464101615137754*dxC[0]*eUp[0]-3.464101615137754*dxC[0]*eLo[0])*dxF[1]*eUp1R2+(3.464101615137754*dxC[0]*eLo[0]-3.464101615137754*dxC[0]*eUp[0])*dxF[1]*eLo1R2)*fldC[2]+(((13.85640646055102*eUp[0]-13.85640646055102*eLo[0])*wF[0]+(13.85640646055102*eLo[0]-13.85640646055102*eUp[0])*wC[0]+3.464101615137754*dxF[0]*eUp0R2-3.464101615137754*dxF[0]*eLo0R2)*dxC[1]*eUp[1]+((13.85640646055102*eLo[0]-13.85640646055102*eUp[0])*wF[0]+(13.85640646055102*eUp[0]-13.85640646055102*eLo[0])*wC[0]-3.464101615137754*dxF[0]*eUp0R2+3.464101615137754*dxF[0]*eLo0R2)*dxC[1]*eLo[1])*fldC[1]+(4.0*dxC[0]*eUp[0]-4.0*dxC[0]*eLo[0])*fldC[0]*dxC[1]*eUp[1]+(4.0*dxC[0]*eLo[0]-4.0*dxC[0]*eUp[0])*fldC[0]*dxC[1]*eLo[1]))/(dxC[0]*dxC[1]); 
  fldF[1] += (0.0625*(((((41.56921938165305*eUp0R2-41.56921938165305*eLo0R2)*wF[0]+(41.56921938165305*eLo0R2-41.56921938165305*eUp0R2)*wC[0]+13.85640646055102*dxF[0]*eUp0R3-13.85640646055102*dxF[0]*eLo0R3)*eUp[1]+((41.56921938165305*eLo0R2-41.56921938165305*eUp0R2)*wF[0]+(41.56921938165305*eUp0R2-41.56921938165305*eLo0R2)*wC[0]-13.85640646055102*dxF[0]*eUp0R3+13.85640646055102*dxF[0]*eLo0R3)*eLo[1])*wF[1]+(((41.56921938165305*eLo0R2-41.56921938165305*eUp0R2)*wF[0]+(41.56921938165305*eUp0R2-41.56921938165305*eLo0R2)*wC[0]-13.85640646055102*dxF[0]*eUp0R3+13.85640646055102*dxF[0]*eLo0R3)*eUp[1]+((41.56921938165305*eUp0R2-41.56921938165305*eLo0R2)*wF[0]+(41.56921938165305*eLo0R2-41.56921938165305*eUp0R2)*wC[0]+13.85640646055102*dxF[0]*eUp0R3-13.85640646055102*dxF[0]*eLo0R3)*eLo[1])*wC[1]+((10.39230484541326*eUp0R2-10.39230484541326*eLo0R2)*wF[0]+(10.39230484541326*eLo0R2-10.39230484541326*eUp0R2)*wC[0]+3.464101615137754*dxF[0]*eUp0R3-3.464101615137754*dxF[0]*eLo0R3)*dxF[1]*eUp1R2+((10.39230484541326*eLo0R2-10.39230484541326*eUp0R2)*wF[0]+(10.39230484541326*eUp0R2-10.39230484541326*eLo0R2)*wC[0]-3.464101615137754*dxF[0]*eUp0R3+3.464101615137754*dxF[0]*eLo0R3)*dxF[1]*eLo1R2)*fldC[3]+(((12.0*dxC[0]*eUp0R2-12.0*dxC[0]*eLo0R2)*eUp[1]+(12.0*dxC[0]*eLo0R2-12.0*dxC[0]*eUp0R2)*eLo[1])*wF[1]+((12.0*dxC[0]*eLo0R2-12.0*dxC[0]*eUp0R2)*eUp[1]+(12.0*dxC[0]*eUp0R2-12.0*dxC[0]*eLo0R2)*eLo[1])*wC[1]+(3.0*dxC[0]*eUp0R2-3.0*dxC[0]*eLo0R2)*dxF[1]*eUp1R2+(3.0*dxC[0]*eLo0R2-3.0*dxC[0]*eUp0R2)*dxF[1]*eLo1R2)*fldC[2]+(((12.0*eUp0R2-12.0*eLo0R2)*wF[0]+(12.0*eLo0R2-12.0*eUp0R2)*wC[0]+4.0*dxF[0]*eUp0R3-4.0*dxF[0]*eLo0R3)*dxC[1]*eUp[1]+((12.0*eLo0R2-12.0*eUp0R2)*wF[0]+(12.0*eUp0R2-12.0*eLo0R2)*wC[0]-4.0*dxF[0]*eUp0R3+4.0*dxF[0]*eLo0R3)*dxC[1]*eLo[1])*fldC[1]+(3.464101615137754*dxC[0]*eUp0R2-3.464101615137754*dxC[0]*eLo0R2)*fldC[0]*dxC[1]*eUp[1]+(3.464101615137754*dxC[0]*eLo0R2-3.464101615137754*dxC[0]*eUp0R2)*fldC[0]*dxC[1]*eLo[1]))/(dxC[0]*dxC[1]); 
  fldF[2] += (0.0625*(((((41.56921938165305*eUp[0]-41.56921938165305*eLo[0])*wF[0]+(41.56921938165305*eLo[0]-41.56921938165305*eUp[0])*wC[0]+10.39230484541326*dxF[0]*eUp0R2-10.39230484541326*dxF[0]*eLo0R2)*eUp1R2+((41.56921938165305*eLo[0]-41.56921938165305*eUp[0])*wF[0]+(41.56921938165305*eUp[0]-41.56921938165305*eLo[0])*wC[0]-10.39230484541326*dxF[0]*eUp0R2+10.39230484541326*dxF[0]*eLo0R2)*eLo1R2)*wF[1]+(((41.56921938165305*eLo[0]-41.56921938165305*eUp[0])*wF[0]+(41.56921938165305*eUp[0]-41.56921938165305*eLo[0])*wC[0]-10.39230484541326*dxF[0]*eUp0R2+10.39230484541326*dxF[0]*eLo0R2)*eUp1R2+((41.56921938165305*eUp[0]-41.56921938165305*eLo[0])*wF[0]+(41.56921938165305*eLo[0]-41.56921938165305*eUp[0])*wC[0]+10.39230484541326*dxF[0]*eUp0R2-10.39230484541326*dxF[0]*eLo0R2)*eLo1R2)*wC[1]+((13.85640646055102*eUp[0]-13.85640646055102*eLo[0])*wF[0]+(13.85640646055102*eLo[0]-13.85640646055102*eUp[0])*wC[0]+3.464101615137754*dxF[0]*eUp0R2-3.464101615137754*dxF[0]*eLo0R2)*dxF[1]*eUp1R3+((13.85640646055102*eLo[0]-13.85640646055102*eUp[0])*wF[0]+(13.85640646055102*eUp[0]-13.85640646055102*eLo[0])*wC[0]-3.464101615137754*dxF[0]*eUp0R2+3.464101615137754*dxF[0]*eLo0R2)*dxF[1]*eLo1R3)*fldC[3]+(((12.0*dxC[0]*eUp[0]-12.0*dxC[0]*eLo[0])*eUp1R2+(12.0*dxC[0]*eLo[0]-12.0*dxC[0]*eUp[0])*eLo1R2)*wF[1]+((12.0*dxC[0]*eLo[0]-12.0*dxC[0]*eUp[0])*eUp1R2+(12.0*dxC[0]*eUp[0]-12.0*dxC[0]*eLo[0])*eLo1R2)*wC[1]+(4.0*dxC[0]*eUp[0]-4.0*dxC[0]*eLo[0])*dxF[1]*eUp1R3+(4.0*dxC[0]*eLo[0]-4.0*dxC[0]*eUp[0])*dxF[1]*eLo1R3)*fldC[2]+(((12.0*eUp[0]-12.0*eLo[0])*wF[0]+(12.0*eLo[0]-12.0*eUp[0])*wC[0]+3.0*dxF[0]*eUp0R2-3.0*dxF[0]*eLo0R2)*dxC[1]*eUp1R2+((12.0*eLo[0]-12.0*eUp[0])*wF[0]+(12.0*eUp[0]-12.0*eLo[0])*wC[0]-3.0*dxF[0]*eUp0R2+3.0*dxF[0]*eLo0R2)*dxC[1]*eLo1R2)*fldC[1]+(3.464101615137754*dxC[0]*eUp[0]-3.464101615137754*dxC[0]*eLo[0])*fldC[0]*dxC[1]*eUp1R2+(3.464101615137754*dxC[0]*eLo[0]-3.464101615137754*dxC[0]*eUp[0])*fldC[0]*dxC[1]*eLo1R2))/(dxC[0]*dxC[1]); 
  fldF[3] += (0.0625*(((((36.0*eUp0R2-36.0*eLo0R2)*wF[0]+(36.0*eLo0R2-36.0*eUp0R2)*wC[0]+12.0*dxF[0]*eUp0R3-12.0*dxF[0]*eLo0R3)*eUp1R2+((36.0*eLo0R2-36.0*eUp0R2)*wF[0]+(36.0*eUp0R2-36.0*eLo0R2)*wC[0]-12.0*dxF[0]*eUp0R3+12.0*dxF[0]*eLo0R3)*eLo1R2)*wF[1]+(((36.0*eLo0R2-36.0*eUp0R2)*wF[0]+(36.0*eUp0R2-36.0*eLo0R2)*wC[0]-12.0*dxF[0]*eUp0R3+12.0*dxF[0]*eLo0R3)*eUp1R2+((36.0*eUp0R2-36.0*eLo0R2)*wF[0]+(36.0*eLo0R2-36.0*eUp0R2)*wC[0]+12.0*dxF[0]*eUp0R3-12.0*dxF[0]*eLo0R3)*eLo1R2)*wC[1]+((12.0*eUp0R2-12.0*eLo0R2)*wF[0]+(12.0*eLo0R2-12.0*eUp0R2)*wC[0]+4.0*dxF[0]*eUp0R3-4.0*dxF[0]*eLo0R3)*dxF[1]*eUp1R3+((12.0*eLo0R2-12.0*eUp0R2)*wF[0]+(12.0*eUp0R2-12.0*eLo0R2)*wC[0]-4.0*dxF[0]*eUp0R3+4.0*dxF[0]*eLo0R3)*dxF[1]*eLo1R3)*fldC[3]+(((10.39230484541326*dxC[0]*eUp0R2-10.39230484541326*dxC[0]*eLo0R2)*eUp1R2+(10.39230484541326*dxC[0]*eLo0R2-10.39230484541326*dxC[0]*eUp0R2)*eLo1R2)*wF[1]+((10.39230484541326*dxC[0]*eLo0R2-10.39230484541326*dxC[0]*eUp0R2)*eUp1R2+(10.39230484541326*dxC[0]*eUp0R2-10.39230484541326*dxC[0]*eLo0R2)*eLo1R2)*wC[1]+(3.464101615137754*dxC[0]*eUp0R2-3.464101615137754*dxC[0]*eLo0R2)*dxF[1]*eUp1R3+(3.464101615137754*dxC[0]*eLo0R2-3.464101615137754*dxC[0]*eUp0R2)*dxF[1]*eLo1R3)*fldC[2]+(((10.39230484541326*eUp0R2-10.39230484541326*eLo0R2)*wF[0]+(10.39230484541326*eLo0R2-10.39230484541326*eUp0R2)*wC[0]+3.464101615137754*dxF[0]*eUp0R3-3.464101615137754*dxF[0]*eLo0R3)*dxC[1]*eUp1R2+((10.39230484541326*eLo0R2-10.39230484541326*eUp0R2)*wF[0]+(10.39230484541326*eUp0R2-10.39230484541326*eLo0R2)*wC[0]-3.464101615137754*dxF[0]*eUp0R3+3.464101615137754*dxF[0]*eLo0R3)*dxC[1]*eLo1R2)*fldC[1]+(3.0*dxC[0]*eUp0R2-3.0*dxC[0]*eLo0R2)*fldC[0]*dxC[1]*eUp1R2+(3.0*dxC[0]*eLo0R2-3.0*dxC[0]*eUp0R2)*fldC[0]*dxC[1]*eLo1R2))/(dxC[0]*dxC[1]); 

}

